<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js"></script>
</head>
<body>
  <div>
    <label for="json_rules">json rules (["repo".git,"key","schema"]):</label>
    <input type="text" id="json_rules">
    <button onclick="generate()">Generate</button>
  </div>

  <div id='editor_holder'></div>
  <button id='submit'>Submit</button>

  <script>
    function generate() {
      const jsonRules = document.getElementById("json_rules");
      var data = undefined;
      try {
        data = JSON.parse(json_rules.value);
      } catch(e) {
        alert(e);
        return;
      }
      
      var editor = new JSONEditor(document.getElementById('editor_holder'), 
      {
        schema: JSON.parse(data.schema)
      });

      // Hook up the submit button to log to the console
      document.getElementById('submit').addEventListener('click', function () {
        // Get the value from the editor
        alert(`Submitting ${JSON.stringify(editor.getValue())} to ${data.repo} with key ${data.key}` );
      });
    }
  </script>
</body>
</html>